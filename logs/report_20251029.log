[2025-10-29 11:36:38] Context:  | Error: In argument: `ema_12 = if (...) NULL`.
Call: mutate(., n_obs = n(), price_change = yield_to_maturity - lag(yield_to_maturity,      1), gain = ifelse(is.na(price_change), 0, pmax(0, price_change)),      loss = ifelse(is.na(price_change), 0, pmax(0, -price_change)),      avg_gain = zoo::rollmeanr(gain, k = min(14, n_obs), fill = 0),      avg_loss = zoo::rollmeanr(loss, k = min(14, n_obs), fill = 0),      rsi_14 = TTR::RSI(yield_to_maturity, n = min(14, n_obs),          maType = "WMA"), rsi_14 = ifelse(is.na(rsi_14) & n_obs <          14, NA_real_, rsi_14), bb_mean = zoo::rollmeanr(yield_to_maturity,          k = min(20, n_obs), fill = mean(yield_to_maturity, na.rm = TRUE)),      bb_sd = zoo::rollapplyr(yield_to_maturity, width = min(20,          n_obs), FUN = function(x) {         s <- sd(x, na.rm = TRUE)         ifelse(is.na(s) | s < 0.01, 0.1, s)     }, fill = 0.1, partial = TRUE), bb_upper = bb_mean + 2 *          bb_sd, bb_lower = bb_mean - 2 * bb_sd, bb_upper_2 = bb_upper,      bb_lower_2 = bb_lower, bb_upper_1 = bb_mean + bb_sd, bb_lower_1 = bb_mean -          bb_sd, bb_width = bb_upper - bb_lower, bb_width_pct = (bb_width/bb_mean) *          100, bb_position = (yield_to_maturity - bb_lower)/pmax(0.01,          bb_width), sma_50 = zoo::rollmeanr(yield_to_maturity,          k = min(50, n_obs), fill = yield_to_maturity), sma_200 = zoo::rollmeanr(yield_to_maturity,          k = min(200, n_obs), fill = yield_to_maturity), ema_12 = if (n_obs >=          12) {         TTR::EMA(yield_to_maturity, n = 12)     } else if (n_obs >= 3) {         TTR::EMA(yield_to_maturity, n = n_obs)     } else {         yield_to_maturity     }, ema_26 = if (n_obs >= 26) {         TTR::EMA(yield_to_maturity, n = 26)     } else if (n_obs >= 3) {         TTR::EMA(yield_to_maturity, n = n_obs)     } else {         yield_to_maturity     }, ema_12 = ifelse(is.na(ema_12), yield_to_maturity, ema_12),      ema_26 = ifelse(is.na(ema_26), yield_to_maturity, ema_26),      macd = ema_12 - ema_26, macd_signal = if (sum(!is.na(macd)) >=          9) {         signal_line <- TTR::EMA(macd, n = 9)         ifelse(is.na(signal_line), 0, signal_line)     } else if (sum(!is.na(macd)) >= 3) {         signal_line <- TTR::EMA(macd, n = sum(!is.na(macd)))         ifelse(is.na(signal_line), 0, signal_line)     } else {         0     }, macd_histogram = macd - macd_signal, roc_5 = case_when(n_obs <=          5 ~ 0, is.na(lag(yield_to_maturity, 5)) ~ 0, lag(yield_to_maturity,          5) == 0 ~ 0, TRUE ~ (yield_to_maturity - lag(yield_to_maturity,          5))/lag(yield_to_maturity, 5) * 100), roc_20 = case_when(n_obs <=          20 ~ 0, is.na(lag(yield_to_maturity, 20)) ~ 0, lag(yield_to_maturity,          20) == 0 ~ 0, TRUE ~ (yield_to_maturity - lag(yield_to_maturity,          20))/lag(yield_to_maturity, 20) * 100), resistance_1m = zoo::rollmaxr(yield_to_maturity,          k = min(20, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      support_1m = zoo::rollapplyr(yield_to_maturity, width = min(20,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), resistance_3m = zoo::rollmaxr(yield_to_maturity,          k = min(60, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      support_3m = zoo::rollapplyr(yield_to_maturity, width = min(60,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), highest_14 = zoo::rollmaxr(yield_to_maturity,          k = min(14, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      lowest_14 = zoo::rollapplyr(yield_to_maturity, width = min(14,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), williams_r = case_when(n_obs <          14 ~ -50, (highest_14 - lowest_14) == 0 ~ -50, TRUE ~          ((highest_14 - yield_to_maturity)/(highest_14 - lowest_14)) *              -100), rsi_highest_14 = zoo::rollmaxr(rsi_14, k = min(14,          n_obs), fill = 100), lowest_14 = zoo::rollapplyr(yield_to_maturity,          width = min(14, n_obs), FUN = function(x) min(x, na.rm = TRUE),          fill = min(yield_to_maturity, na.rm = TRUE), partial = TRUE),      rsi_highest_14 = zoo::rollmaxr(rsi_14, k = min(14, n_obs),          fill = 100), rsi_lowest_14 = zoo::rollapplyr(rsi_14,          width = min(14, n_obs), FUN = function(x) min(x, na.rm = TRUE),          fill = 0, partial = TRUE), stoch_rsi = case_when(n_obs <          14 ~ 0.5, (rsi_highest_14 - rsi_lowest_14) == 0 ~ 0.5,          TRUE ~ (rsi_14 - rsi_lowest_14)/(rsi_highest_14 - rsi_lowest_14)),      daily_return = (yield_to_maturity - lag(yield_to_maturity,          1))/lag(yield_to_maturity, 1) * 100, historical_vol = zoo::rollapplyr(daily_return,          width = min(20, n_obs), FUN = function(x) {             vol <- sd(x, na.rm = TRUE)             ifelse(is.na(vol), 10, vol * sqrt(252))         }, fill = 10, partial = TRUE), mean_20 = bb_mean, z_score_20 = (yield_to_maturity -          bb_mean)/pmax(0.01, bb_sd))
[2025-10-29 11:36:40] Context:  | Error: In argument: `ema_12 = if (...) NULL`.
Call: mutate(., n_obs = n(), price_change = yield_to_maturity - lag(yield_to_maturity,      1), gain = ifelse(is.na(price_change), 0, pmax(0, price_change)),      loss = ifelse(is.na(price_change), 0, pmax(0, -price_change)),      avg_gain = zoo::rollmeanr(gain, k = min(14, n_obs), fill = 0),      avg_loss = zoo::rollmeanr(loss, k = min(14, n_obs), fill = 0),      rsi_14 = TTR::RSI(yield_to_maturity, n = min(14, n_obs),          maType = "WMA"), rsi_14 = ifelse(is.na(rsi_14) & n_obs <          14, NA_real_, rsi_14), bb_mean = zoo::rollmeanr(yield_to_maturity,          k = min(20, n_obs), fill = mean(yield_to_maturity, na.rm = TRUE)),      bb_sd = zoo::rollapplyr(yield_to_maturity, width = min(20,          n_obs), FUN = function(x) {         s <- sd(x, na.rm = TRUE)         ifelse(is.na(s) | s < 0.01, 0.1, s)     }, fill = 0.1, partial = TRUE), bb_upper = bb_mean + 2 *          bb_sd, bb_lower = bb_mean - 2 * bb_sd, bb_upper_2 = bb_upper,      bb_lower_2 = bb_lower, bb_upper_1 = bb_mean + bb_sd, bb_lower_1 = bb_mean -          bb_sd, bb_width = bb_upper - bb_lower, bb_width_pct = (bb_width/bb_mean) *          100, bb_position = (yield_to_maturity - bb_lower)/pmax(0.01,          bb_width), sma_50 = zoo::rollmeanr(yield_to_maturity,          k = min(50, n_obs), fill = yield_to_maturity), sma_200 = zoo::rollmeanr(yield_to_maturity,          k = min(200, n_obs), fill = yield_to_maturity), ema_12 = if (n_obs >=          12) {         TTR::EMA(yield_to_maturity, n = 12)     } else if (n_obs >= 3) {         TTR::EMA(yield_to_maturity, n = n_obs)     } else {         yield_to_maturity     }, ema_26 = if (n_obs >= 26) {         TTR::EMA(yield_to_maturity, n = 26)     } else if (n_obs >= 3) {         TTR::EMA(yield_to_maturity, n = n_obs)     } else {         yield_to_maturity     }, ema_12 = ifelse(is.na(ema_12), yield_to_maturity, ema_12),      ema_26 = ifelse(is.na(ema_26), yield_to_maturity, ema_26),      macd = ema_12 - ema_26, macd_signal = if (sum(!is.na(macd)) >=          9) {         signal_line <- TTR::EMA(macd, n = 9)         ifelse(is.na(signal_line), 0, signal_line)     } else if (sum(!is.na(macd)) >= 3) {         signal_line <- TTR::EMA(macd, n = sum(!is.na(macd)))         ifelse(is.na(signal_line), 0, signal_line)     } else {         0     }, macd_histogram = macd - macd_signal, roc_5 = case_when(n_obs <=          5 ~ 0, is.na(lag(yield_to_maturity, 5)) ~ 0, lag(yield_to_maturity,          5) == 0 ~ 0, TRUE ~ (yield_to_maturity - lag(yield_to_maturity,          5))/lag(yield_to_maturity, 5) * 100), roc_20 = case_when(n_obs <=          20 ~ 0, is.na(lag(yield_to_maturity, 20)) ~ 0, lag(yield_to_maturity,          20) == 0 ~ 0, TRUE ~ (yield_to_maturity - lag(yield_to_maturity,          20))/lag(yield_to_maturity, 20) * 100), resistance_1m = zoo::rollmaxr(yield_to_maturity,          k = min(20, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      support_1m = zoo::rollapplyr(yield_to_maturity, width = min(20,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), resistance_3m = zoo::rollmaxr(yield_to_maturity,          k = min(60, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      support_3m = zoo::rollapplyr(yield_to_maturity, width = min(60,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), highest_14 = zoo::rollmaxr(yield_to_maturity,          k = min(14, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      lowest_14 = zoo::rollapplyr(yield_to_maturity, width = min(14,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), williams_r = case_when(n_obs <          14 ~ -50, (highest_14 - lowest_14) == 0 ~ -50, TRUE ~          ((highest_14 - yield_to_maturity)/(highest_14 - lowest_14)) *              -100), rsi_highest_14 = zoo::rollmaxr(rsi_14, k = min(14,          n_obs), fill = 100), lowest_14 = zoo::rollapplyr(yield_to_maturity,          width = min(14, n_obs), FUN = function(x) min(x, na.rm = TRUE),          fill = min(yield_to_maturity, na.rm = TRUE), partial = TRUE),      rsi_highest_14 = zoo::rollmaxr(rsi_14, k = min(14, n_obs),          fill = 100), rsi_lowest_14 = zoo::rollapplyr(rsi_14,          width = min(14, n_obs), FUN = function(x) min(x, na.rm = TRUE),          fill = 0, partial = TRUE), stoch_rsi = case_when(n_obs <          14 ~ 0.5, (rsi_highest_14 - rsi_lowest_14) == 0 ~ 0.5,          TRUE ~ (rsi_14 - rsi_lowest_14)/(rsi_highest_14 - rsi_lowest_14)),      daily_return = (yield_to_maturity - lag(yield_to_maturity,          1))/lag(yield_to_maturity, 1) * 100, historical_vol = zoo::rollapplyr(daily_return,          width = min(20, n_obs), FUN = function(x) {             vol <- sd(x, na.rm = TRUE)             ifelse(is.na(vol), 10, vol * sqrt(252))         }, fill = 10, partial = TRUE), mean_20 = bb_mean, z_score_20 = (yield_to_maturity -          bb_mean)/pmax(0.01, bb_sd))
[2025-10-29 11:36:53] Context:  | Error: In argument: `ema_12 = if (...) NULL`.
Call: mutate(., n_obs = n(), price_change = yield_to_maturity - lag(yield_to_maturity,      1), gain = ifelse(is.na(price_change), 0, pmax(0, price_change)),      loss = ifelse(is.na(price_change), 0, pmax(0, -price_change)),      avg_gain = zoo::rollmeanr(gain, k = min(14, n_obs), fill = 0),      avg_loss = zoo::rollmeanr(loss, k = min(14, n_obs), fill = 0),      rsi_14 = TTR::RSI(yield_to_maturity, n = min(14, n_obs),          maType = "WMA"), rsi_14 = ifelse(is.na(rsi_14) & n_obs <          14, NA_real_, rsi_14), bb_mean = zoo::rollmeanr(yield_to_maturity,          k = min(20, n_obs), fill = mean(yield_to_maturity, na.rm = TRUE)),      bb_sd = zoo::rollapplyr(yield_to_maturity, width = min(20,          n_obs), FUN = function(x) {         s <- sd(x, na.rm = TRUE)         ifelse(is.na(s) | s < 0.01, 0.1, s)     }, fill = 0.1, partial = TRUE), bb_upper = bb_mean + 2 *          bb_sd, bb_lower = bb_mean - 2 * bb_sd, bb_upper_2 = bb_upper,      bb_lower_2 = bb_lower, bb_upper_1 = bb_mean + bb_sd, bb_lower_1 = bb_mean -          bb_sd, bb_width = bb_upper - bb_lower, bb_width_pct = (bb_width/bb_mean) *          100, bb_position = (yield_to_maturity - bb_lower)/pmax(0.01,          bb_width), sma_50 = zoo::rollmeanr(yield_to_maturity,          k = min(50, n_obs), fill = yield_to_maturity), sma_200 = zoo::rollmeanr(yield_to_maturity,          k = min(200, n_obs), fill = yield_to_maturity), ema_12 = if (n_obs >=          12) {         TTR::EMA(yield_to_maturity, n = 12)     } else if (n_obs >= 3) {         TTR::EMA(yield_to_maturity, n = n_obs)     } else {         yield_to_maturity     }, ema_26 = if (n_obs >= 26) {         TTR::EMA(yield_to_maturity, n = 26)     } else if (n_obs >= 3) {         TTR::EMA(yield_to_maturity, n = n_obs)     } else {         yield_to_maturity     }, ema_12 = ifelse(is.na(ema_12), yield_to_maturity, ema_12),      ema_26 = ifelse(is.na(ema_26), yield_to_maturity, ema_26),      macd = ema_12 - ema_26, macd_signal = if (sum(!is.na(macd)) >=          9) {         signal_line <- TTR::EMA(macd, n = 9)         ifelse(is.na(signal_line), 0, signal_line)     } else if (sum(!is.na(macd)) >= 3) {         signal_line <- TTR::EMA(macd, n = sum(!is.na(macd)))         ifelse(is.na(signal_line), 0, signal_line)     } else {         0     }, macd_histogram = macd - macd_signal, roc_5 = case_when(n_obs <=          5 ~ 0, is.na(lag(yield_to_maturity, 5)) ~ 0, lag(yield_to_maturity,          5) == 0 ~ 0, TRUE ~ (yield_to_maturity - lag(yield_to_maturity,          5))/lag(yield_to_maturity, 5) * 100), roc_20 = case_when(n_obs <=          20 ~ 0, is.na(lag(yield_to_maturity, 20)) ~ 0, lag(yield_to_maturity,          20) == 0 ~ 0, TRUE ~ (yield_to_maturity - lag(yield_to_maturity,          20))/lag(yield_to_maturity, 20) * 100), resistance_1m = zoo::rollmaxr(yield_to_maturity,          k = min(20, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      support_1m = zoo::rollapplyr(yield_to_maturity, width = min(20,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), resistance_3m = zoo::rollmaxr(yield_to_maturity,          k = min(60, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      support_3m = zoo::rollapplyr(yield_to_maturity, width = min(60,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), highest_14 = zoo::rollmaxr(yield_to_maturity,          k = min(14, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      lowest_14 = zoo::rollapplyr(yield_to_maturity, width = min(14,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), williams_r = case_when(n_obs <          14 ~ -50, (highest_14 - lowest_14) == 0 ~ -50, TRUE ~          ((highest_14 - yield_to_maturity)/(highest_14 - lowest_14)) *              -100), rsi_highest_14 = zoo::rollmaxr(rsi_14, k = min(14,          n_obs), fill = 100), lowest_14 = zoo::rollapplyr(yield_to_maturity,          width = min(14, n_obs), FUN = function(x) min(x, na.rm = TRUE),          fill = min(yield_to_maturity, na.rm = TRUE), partial = TRUE),      rsi_highest_14 = zoo::rollmaxr(rsi_14, k = min(14, n_obs),          fill = 100), rsi_lowest_14 = zoo::rollapplyr(rsi_14,          width = min(14, n_obs), FUN = function(x) min(x, na.rm = TRUE),          fill = 0, partial = TRUE), stoch_rsi = case_when(n_obs <          14 ~ 0.5, (rsi_highest_14 - rsi_lowest_14) == 0 ~ 0.5,          TRUE ~ (rsi_14 - rsi_lowest_14)/(rsi_highest_14 - rsi_lowest_14)),      daily_return = (yield_to_maturity - lag(yield_to_maturity,          1))/lag(yield_to_maturity, 1) * 100, historical_vol = zoo::rollapplyr(daily_return,          width = min(20, n_obs), FUN = function(x) {             vol <- sd(x, na.rm = TRUE)             ifelse(is.na(vol), 10, vol * sqrt(252))         }, fill = 10, partial = TRUE), mean_20 = bb_mean, z_score_20 = (yield_to_maturity -          bb_mean)/pmax(0.01, bb_sd))
[2025-10-29 11:36:54] Context:  | Error: In argument: `ema_12 = if (...) NULL`.
Call: mutate(., n_obs = n(), price_change = yield_to_maturity - lag(yield_to_maturity,      1), gain = ifelse(is.na(price_change), 0, pmax(0, price_change)),      loss = ifelse(is.na(price_change), 0, pmax(0, -price_change)),      avg_gain = zoo::rollmeanr(gain, k = min(14, n_obs), fill = 0),      avg_loss = zoo::rollmeanr(loss, k = min(14, n_obs), fill = 0),      rsi_14 = TTR::RSI(yield_to_maturity, n = min(14, n_obs),          maType = "WMA"), rsi_14 = ifelse(is.na(rsi_14) & n_obs <          14, NA_real_, rsi_14), bb_mean = zoo::rollmeanr(yield_to_maturity,          k = min(20, n_obs), fill = mean(yield_to_maturity, na.rm = TRUE)),      bb_sd = zoo::rollapplyr(yield_to_maturity, width = min(20,          n_obs), FUN = function(x) {         s <- sd(x, na.rm = TRUE)         ifelse(is.na(s) | s < 0.01, 0.1, s)     }, fill = 0.1, partial = TRUE), bb_upper = bb_mean + 2 *          bb_sd, bb_lower = bb_mean - 2 * bb_sd, bb_upper_2 = bb_upper,      bb_lower_2 = bb_lower, bb_upper_1 = bb_mean + bb_sd, bb_lower_1 = bb_mean -          bb_sd, bb_width = bb_upper - bb_lower, bb_width_pct = (bb_width/bb_mean) *          100, bb_position = (yield_to_maturity - bb_lower)/pmax(0.01,          bb_width), sma_50 = zoo::rollmeanr(yield_to_maturity,          k = min(50, n_obs), fill = yield_to_maturity), sma_200 = zoo::rollmeanr(yield_to_maturity,          k = min(200, n_obs), fill = yield_to_maturity), ema_12 = if (n_obs >=          12) {         TTR::EMA(yield_to_maturity, n = 12)     } else if (n_obs >= 3) {         TTR::EMA(yield_to_maturity, n = n_obs)     } else {         yield_to_maturity     }, ema_26 = if (n_obs >= 26) {         TTR::EMA(yield_to_maturity, n = 26)     } else if (n_obs >= 3) {         TTR::EMA(yield_to_maturity, n = n_obs)     } else {         yield_to_maturity     }, ema_12 = ifelse(is.na(ema_12), yield_to_maturity, ema_12),      ema_26 = ifelse(is.na(ema_26), yield_to_maturity, ema_26),      macd = ema_12 - ema_26, macd_signal = if (sum(!is.na(macd)) >=          9) {         signal_line <- TTR::EMA(macd, n = 9)         ifelse(is.na(signal_line), 0, signal_line)     } else if (sum(!is.na(macd)) >= 3) {         signal_line <- TTR::EMA(macd, n = sum(!is.na(macd)))         ifelse(is.na(signal_line), 0, signal_line)     } else {         0     }, macd_histogram = macd - macd_signal, roc_5 = case_when(n_obs <=          5 ~ 0, is.na(lag(yield_to_maturity, 5)) ~ 0, lag(yield_to_maturity,          5) == 0 ~ 0, TRUE ~ (yield_to_maturity - lag(yield_to_maturity,          5))/lag(yield_to_maturity, 5) * 100), roc_20 = case_when(n_obs <=          20 ~ 0, is.na(lag(yield_to_maturity, 20)) ~ 0, lag(yield_to_maturity,          20) == 0 ~ 0, TRUE ~ (yield_to_maturity - lag(yield_to_maturity,          20))/lag(yield_to_maturity, 20) * 100), resistance_1m = zoo::rollmaxr(yield_to_maturity,          k = min(20, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      support_1m = zoo::rollapplyr(yield_to_maturity, width = min(20,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), resistance_3m = zoo::rollmaxr(yield_to_maturity,          k = min(60, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      support_3m = zoo::rollapplyr(yield_to_maturity, width = min(60,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), highest_14 = zoo::rollmaxr(yield_to_maturity,          k = min(14, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      lowest_14 = zoo::rollapplyr(yield_to_maturity, width = min(14,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), williams_r = case_when(n_obs <          14 ~ -50, (highest_14 - lowest_14) == 0 ~ -50, TRUE ~          ((highest_14 - yield_to_maturity)/(highest_14 - lowest_14)) *              -100), rsi_highest_14 = zoo::rollmaxr(rsi_14, k = min(14,          n_obs), fill = 100), lowest_14 = zoo::rollapplyr(yield_to_maturity,          width = min(14, n_obs), FUN = function(x) min(x, na.rm = TRUE),          fill = min(yield_to_maturity, na.rm = TRUE), partial = TRUE),      rsi_highest_14 = zoo::rollmaxr(rsi_14, k = min(14, n_obs),          fill = 100), rsi_lowest_14 = zoo::rollapplyr(rsi_14,          width = min(14, n_obs), FUN = function(x) min(x, na.rm = TRUE),          fill = 0, partial = TRUE), stoch_rsi = case_when(n_obs <          14 ~ 0.5, (rsi_highest_14 - rsi_lowest_14) == 0 ~ 0.5,          TRUE ~ (rsi_14 - rsi_lowest_14)/(rsi_highest_14 - rsi_lowest_14)),      daily_return = (yield_to_maturity - lag(yield_to_maturity,          1))/lag(yield_to_maturity, 1) * 100, historical_vol = zoo::rollapplyr(daily_return,          width = min(20, n_obs), FUN = function(x) {             vol <- sd(x, na.rm = TRUE)             ifelse(is.na(vol), 10, vol * sqrt(252))         }, fill = 10, partial = TRUE), mean_20 = bb_mean, z_score_20 = (yield_to_maturity -          bb_mean)/pmax(0.01, bb_sd))
[2025-10-29 11:36:54] Context:  | Error: In argument: `ema_12 = if (...) NULL`.
Call: mutate(., n_obs = n(), price_change = yield_to_maturity - lag(yield_to_maturity,      1), gain = ifelse(is.na(price_change), 0, pmax(0, price_change)),      loss = ifelse(is.na(price_change), 0, pmax(0, -price_change)),      avg_gain = zoo::rollmeanr(gain, k = min(14, n_obs), fill = 0),      avg_loss = zoo::rollmeanr(loss, k = min(14, n_obs), fill = 0),      rsi_14 = TTR::RSI(yield_to_maturity, n = min(14, n_obs),          maType = "WMA"), rsi_14 = ifelse(is.na(rsi_14) & n_obs <          14, NA_real_, rsi_14), bb_mean = zoo::rollmeanr(yield_to_maturity,          k = min(20, n_obs), fill = mean(yield_to_maturity, na.rm = TRUE)),      bb_sd = zoo::rollapplyr(yield_to_maturity, width = min(20,          n_obs), FUN = function(x) {         s <- sd(x, na.rm = TRUE)         ifelse(is.na(s) | s < 0.01, 0.1, s)     }, fill = 0.1, partial = TRUE), bb_upper = bb_mean + 2 *          bb_sd, bb_lower = bb_mean - 2 * bb_sd, bb_upper_2 = bb_upper,      bb_lower_2 = bb_lower, bb_upper_1 = bb_mean + bb_sd, bb_lower_1 = bb_mean -          bb_sd, bb_width = bb_upper - bb_lower, bb_width_pct = (bb_width/bb_mean) *          100, bb_position = (yield_to_maturity - bb_lower)/pmax(0.01,          bb_width), sma_50 = zoo::rollmeanr(yield_to_maturity,          k = min(50, n_obs), fill = yield_to_maturity), sma_200 = zoo::rollmeanr(yield_to_maturity,          k = min(200, n_obs), fill = yield_to_maturity), ema_12 = if (n_obs >=          12) {         TTR::EMA(yield_to_maturity, n = 12)     } else if (n_obs >= 3) {         TTR::EMA(yield_to_maturity, n = n_obs)     } else {         yield_to_maturity     }, ema_26 = if (n_obs >= 26) {         TTR::EMA(yield_to_maturity, n = 26)     } else if (n_obs >= 3) {         TTR::EMA(yield_to_maturity, n = n_obs)     } else {         yield_to_maturity     }, ema_12 = ifelse(is.na(ema_12), yield_to_maturity, ema_12),      ema_26 = ifelse(is.na(ema_26), yield_to_maturity, ema_26),      macd = ema_12 - ema_26, macd_signal = if (sum(!is.na(macd)) >=          9) {         signal_line <- TTR::EMA(macd, n = 9)         ifelse(is.na(signal_line), 0, signal_line)     } else if (sum(!is.na(macd)) >= 3) {         signal_line <- TTR::EMA(macd, n = sum(!is.na(macd)))         ifelse(is.na(signal_line), 0, signal_line)     } else {         0     }, macd_histogram = macd - macd_signal, roc_5 = case_when(n_obs <=          5 ~ 0, is.na(lag(yield_to_maturity, 5)) ~ 0, lag(yield_to_maturity,          5) == 0 ~ 0, TRUE ~ (yield_to_maturity - lag(yield_to_maturity,          5))/lag(yield_to_maturity, 5) * 100), roc_20 = case_when(n_obs <=          20 ~ 0, is.na(lag(yield_to_maturity, 20)) ~ 0, lag(yield_to_maturity,          20) == 0 ~ 0, TRUE ~ (yield_to_maturity - lag(yield_to_maturity,          20))/lag(yield_to_maturity, 20) * 100), resistance_1m = zoo::rollmaxr(yield_to_maturity,          k = min(20, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      support_1m = zoo::rollapplyr(yield_to_maturity, width = min(20,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), resistance_3m = zoo::rollmaxr(yield_to_maturity,          k = min(60, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      support_3m = zoo::rollapplyr(yield_to_maturity, width = min(60,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), highest_14 = zoo::rollmaxr(yield_to_maturity,          k = min(14, n_obs), fill = max(yield_to_maturity, na.rm = TRUE)),      lowest_14 = zoo::rollapplyr(yield_to_maturity, width = min(14,          n_obs), FUN = function(x) min(x, na.rm = TRUE), fill = min(yield_to_maturity,          na.rm = TRUE), partial = TRUE), williams_r = case_when(n_obs <          14 ~ -50, (highest_14 - lowest_14) == 0 ~ -50, TRUE ~          ((highest_14 - yield_to_maturity)/(highest_14 - lowest_14)) *              -100), rsi_highest_14 = zoo::rollmaxr(rsi_14, k = min(14,          n_obs), fill = 100), lowest_14 = zoo::rollapplyr(yield_to_maturity,          width = min(14, n_obs), FUN = function(x) min(x, na.rm = TRUE),          fill = min(yield_to_maturity, na.rm = TRUE), partial = TRUE),      rsi_highest_14 = zoo::rollmaxr(rsi_14, k = min(14, n_obs),          fill = 100), rsi_lowest_14 = zoo::rollapplyr(rsi_14,          width = min(14, n_obs), FUN = function(x) min(x, na.rm = TRUE),          fill = 0, partial = TRUE), stoch_rsi = case_when(n_obs <          14 ~ 0.5, (rsi_highest_14 - rsi_lowest_14) == 0 ~ 0.5,          TRUE ~ (rsi_14 - rsi_lowest_14)/(rsi_highest_14 - rsi_lowest_14)),      daily_return = (yield_to_maturity - lag(yield_to_maturity,          1))/lag(yield_to_maturity, 1) * 100, historical_vol = zoo::rollapplyr(daily_return,          width = min(20, n_obs), FUN = function(x) {             vol <- sd(x, na.rm = TRUE)             ifelse(is.na(vol), 10, vol * sqrt(252))         }, fill = 10, partial = TRUE), mean_20 = bb_mean, z_score_20 = (yield_to_maturity -          bb_mean)/pmax(0.01, bb_sd))
